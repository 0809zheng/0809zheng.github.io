---
layout: post
title: 'DBSCAN(Density-Based Spatial Clustering of Applications with Noise)'
date: 2020-06-03
author: 郑之杰
cover: 'https://pic1.imgdb.cn/item/684ff58b58cb8da5c850891b.png'
tags: 机器学习
---

> Density-Based Spatial Clustering of Applications with Noise.

**DBSCAN（Density-Based Spatial Clustering of Applications with Noise）**是一种基于密度的聚类算法。相比于传统的基于距离的聚类算法（如**K-Means**），**DBSCAN**不需要预先指定聚类数量，能够自动发现任意形状的聚类簇，并能够有效地处理噪声数据。

![](https://pic1.imgdb.cn/item/684ff58b58cb8da5c850891b.png)

**DBSCAN**算法的基本思想是将数据点分为三类：核心点、边界点和噪声点。
- **核心点(core-point)**是指在以该点为圆心，以设定的半径$ε$为半径的圆内，包含大于等于设定的最小样本数$M$的点；
- **边界点(border-point)**是指在以该点为圆心，以设定的半径$ε$为半径的圆内包含核心点的其余点；
- **噪声点(noise-point)**是指既不是核心点也不是边界点的点。

如下图所示，**A**为核心点，**B、C**是边界点，而**N**是噪声点。

![](https://pic1.imgdb.cn/item/684fdf4058cb8da5c84fbaa1.png)

**DBSCAN**算法的流程如下：
1. 随机选择一个未被访问的数据点；
2. 以该数据点为中心，以设定的半径$ε$为半径，找出该数据点半径范围内的所有数据点；
3. 如果该数据点半径范围内的数据点数量大于等于设定的最小样本数$M$，则将该数据点标记为核心点，并将半径范围内的所有数据点加入该核心点的簇中；
4. 如果该数据点半径范围内的数据点数量小于设定的最小样本数$M$，则将该数据点标记为噪声点；
5. 对于核心点的簇，以同样的方式递归地寻找其邻域内的数据点，并将其加入簇中；
6. 直到所有的数据点都被访问过。

在**DBSCAN**算法中，最重要的参数是邻域半径$ε$和邻域密度阈值$M$，它们需要根据数据集的特点和实际需求来进行调整。

一般而言，较大的$ε$会产生较少的簇，较小的$ε$会产生较多的簇。

![](https://pic1.imgdb.cn/item/684fe0ca58cb8da5c84fc581.png)

较大的$M$会产生较多的噪声点，较小的$M$会产生较少的噪声点。

![](https://pic1.imgdb.cn/item/684fe12158cb8da5c84fc7ce.png)

**DBSCAN**算法的主要优点是不需要提前设置聚类的个数；缺点是需要提前确定$ε$和$M$值；对初值选取敏感，对噪声不敏感；对密度不均的数据聚合效果不好。

使用**sklearn**库实现**DBSCAN**算法：

```python
import numpy as np
from sklearn.cluster import DBSCAN
import matplotlib.pyplot as plt

# 生成随机数据
np.random.seed(42)
data = np.random.randn(1000, 2) * 3 + 10

# 调用DBSCAN算法
model = DBSCAN(eps=2.5, min_samples=5)
y_pred = model.fit_predict(data)

# 可视化结果
plt.scatter(data[:, 0], data[:, 1], c=y_pred)
plt.title('DBSCAN')
plt.xlabel('X')
plt.ylabel('Y')
plt.show()
```