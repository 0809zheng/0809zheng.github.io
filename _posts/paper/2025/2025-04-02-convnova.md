---
layout: post
title: 'Revisiting Convolution Architecture in the Realm of DNA Foundation Models'
date: 2025-04-02
author: 郑之杰
cover: 'https://pic1.imgdb.cn/item/6808a43158cb8da5c8c59f90.png'
tags: 论文阅读
---

> 重新回顾DNA基础模型中的卷积结构.

- paper：[Revisiting Convolution Architecture in the Realm of DNA Foundation Models](https://arxiv.org/abs/2502.18538)

# 0. TL; DR

本文介绍了一种名为**ConvNova**的卷积神经网络（**CNN**），用于**DNA**基础模型的研究。尽管**Transformer**和状态空间模型（**SSM**）在**DNA**建模领域取得了显著进展，但**CNN**作为一种经典的架构，仍然具有强大的竞争力。**ConvNova**通过引入三种关键设计：扩张卷积、门控卷积和双分支框架，在多个**DNA**基础模型基准测试中取得了优于或媲美最新方法的性能，同时在参数数量和计算速度上具有显著优势。该研究重新审视了**CNN**在**DNA**建模中的潜力，并展示了其在处理生物序列任务时的独特优势。

# 1. 背景介绍

**DNA**作为生命的基础代码，其序列信息的解析对于生物医学研究具有重要意义。近年来，随着深度学习技术的发展，基于**Transformer**和状态空间模型（**SSM**）的**DNA**语言模型取得了显著进展，例如**DNABERT**、**Nucleotide Transformer**和**HyenaDNA**等。这些模型在基因表达预测、**DNA**甲基化分析、染色质状态分析等任务中表现出色。然而，卷积神经网络（**CNN**）作为早期在生物信息学中广泛使用的模型，其在**DNA**建模中的潜力尚未得到充分挖掘。

**CNN**在处理**DNA**序列时具有独特的优势。首先，**DNA**序列的下游任务输入长度差异较大（从几十到数千不等），而**Transformer**对序列长度变化不够鲁棒。其次，**Transformer**的计算复杂度为$O(n²)$，远高于**CNN**。此外，**CNN**具有局部归纳偏差，能够更好地利用数据，尤其适合小数据量的任务。然而，目前的研究中，**CNN**与最新的**Transformer**和**SSM**方法之间的系统性比较仍然缺失。因此，本文提出了**ConvNova**，旨在重新评估**CNN**在**DNA**基础模型中的竞争力。

# 2. ConvNova 模型

**ConvNova**的整体架构如图所示。该模型通过卷积操作将**DNA**序列映射到隐空间，然后经过$N$个门控卷积块（**Gated Convolution Blocks, GCBs**），最后通过多层感知机（**MLP**）输出结果。在预训练和下游任务中，模型使用不同的输出头。

![](https://pic1.imgdb.cn/item/6808a58f58cb8da5c8c5b44c.png)

门控卷积的核心思想是通过一个可学习的动态特征选择机制，对每个通道的每个空间位置进行特征选择。具体来说，**GCBs**通过双分支结构实现独立的特征提取，促进互补的表示学习。假设左分支特征为$A ∈ R^{l×d}$，右分支特征为$B ∈ R^{l×d}$，则**GCBs**的计算过程如下：
1. **左分支处理**：首先对左分支特征$A$进行**LayerNorm**，然后通过扩张卷积层和**GELU**激活函数，得到中间特征$h= \text{GELU}(\text{DilatedConv}(A))$；
2. **右分支处理**：对右分支特征$B$进行**LayerNorm**，然后通过扩张卷积层和**Sigmoid**激活函数，得到中间特征$g= \sigma(\text{DilatedConv}(B))$；
3. **特征更新**：左分支特征$A$通过$h$和$g$的逐元素乘法进行更新，右分支特征$B$通过$g$进行更新：

$$
   A = A + h \odot g \\
   B = B + g
$$

这种双分支结构允许模型在特征提取过程中动态地选择和抑制信息，从而提高模型对**DNA**序列中相关信息的捕捉能力。

扩张卷积通过在卷积核中引入间隔，扩大了卷积操作的感受野，而无需进行下采样。这使得模型能够在不减少序列长度的情况下捕捉更广泛的上下文信息。在**ConvNova**中，每个**GCB**的扩张率设置为$[1, 1, d, d², d³, ...]$，其中$d$是扩张步长。通过调整扩张步长，模型可以灵活地控制感受野的大小，从而适应不同任务的需求。

**ConvNova**采用双向掩码语言模型（**MLM**）进行预训练。在预训练过程中，模型随机掩码10%的核苷酸，并预测这些掩码位置的核苷酸类型。预训练数据集为**HG38**，与**HyenaDNA**保持一致。预训练完成后，模型在下游任务上进行微调。在微调阶段，模型使用与**HyenaDNA**相同的池化方法获取每个**DNA**序列的嵌入，并通过线性映射输出标签。

# 3. 实验分析

## 3.1 短序列任务

### 3.1.1 Nucleotide Transformer基准测试

**ConvNova**在**Nucleotide Transformer**基准测试中表现出色，显著优于其他**Transformer**和**SSM**模型。如表所示，**ConvNova**在**18**个任务中的**12**个任务上取得了最佳性能，尤其是在**H3K4me3**任务中，比第二好的方法高出10.5%。此外，**ConvNova**在大多数任务中使用的参数数量较少，计算速度更快。

![](https://pic1.imgdb.cn/item/6808a72358cb8da5c8c5b8ab.png)

### 3.1.2 基因组基准测试

在基因组基准测试中，**ConvNova**在5个任务上超过了基线模型，包括**HyenaDNA**和**Caduceus-ph**。例如，在小鼠增强子任务中，**ConvNova**的**Top-1**准确率达到0.784，优于**HyenaDNA**的0.779和**Caduceus-ph**的0.754。这表明**ConvNova在**处理短序列任务时具有强大的性能。

![](https://pic1.imgdb.cn/item/6808a75058cb8da5c8c5b909.png)

## 3.2 长序列任务

### 3.2.1 基因发现任务

基因发现任务的目标是预测**DNA**序列中的外显子、内含子、供体、受体和非编码区域。**ConvNova**在该任务中取得了最高的**MCC**分数0.55，显著优于其他模型。这表明**ConvNova**能够有效地捕捉长序列中的局部和长程依赖关系，从而实现更准确的基因注释。

![](https://pic1.imgdb.cn/item/6808a77c58cb8da5c8c5b966.png)

### 3.2.2 染色质轮廓预测任务

染色质轮廓预测任务的目标是从**DNA**序列中预测染色质轮廓和表观遗传标记。**ConvNova**在该任务中也表现出色，超过了所有基线模型，包括**DeepATT**（之前该任务的最先进监督模型）。**ConvNova**的平均**AUC**分数达到92.25。

![](https://pic1.imgdb.cn/item/6808a7b058cb8da5c8c5b9c1.png)

## 3.3 消融实验

### 3.3.1 扩张卷积与下采样

实验结果表明，扩张卷积在大多数任务中优于下采样结构。例如，在**H3K4me1**任务中，使用扩张卷积的**ConvNova**达到了56.37的F1分数，而使用下采样的模型仅为34.88。这表明扩张卷积更适合于**DNA**序列建模任务，能够更有效地捕捉上下文信息。

![](https://pic1.imgdb.cn/item/6808a7fd58cb8da5c8c5ba39.png)

### 3.3.2 门控机制与双分支结构

消融实验结果表明，门控机制和双分支结构对**ConvNova**的性能至关重要。如表所示，在**H3**任务中，去掉门控机制的模型性能下降到78.96，而保留门控机制但去掉双分支结构的模型性能为80.95，完整的**ConvNova**模型性能最高，达到81.50。这表明门控机制和双分支结构能够显著提升模型的特征提取能力。

![](https://pic1.imgdb.cn/item/6808a86458cb8da5c8c5bbcf.png)

## 3.4 感受野大小的影响

实验结果表明，不同任务对感受野大小的需求存在显著差异。例如，在**H3K4me2**、**H3K4me3**和**H3K14ac**任务中，较小的感受野（约15%的输入长度）能够取得更好的分类精度。这可能与这些组蛋白标记在转录起始位点附近的富集特性有关。相反，在**H3K9ac**任务中，较大的感受野表现更好，这表明该标记在整个基因体上的分布较为均匀。此外，**H3K4me2**任务中较小的感受野也能取得较好的性能，这可能与其在基因中部的富集特性有关，但具体原因仍需进一步探索。

![](https://pic1.imgdb.cn/item/6808a89258cb8da5c8c5bc0e.png)