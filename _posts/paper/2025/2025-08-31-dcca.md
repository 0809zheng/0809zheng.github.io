---
layout: post
title: 'Deep cross-omics cycle attention model for joint analysis of single-cell multi-omics data'
date: 2025-08-31
author: 郑之杰
cover: 'https://pic1.imgdb.cn/item/69609e6c3278aeeee21d47b4.png'
tags: 论文阅读
---

> 单细胞多组学数据联合分析的深度跨组学循环注意力模型.

- paper：[Deep cross-omics cycle attention model for joint analysis of single-cell multi-omics data](https://academic.oup.com/bioinformatics/article/37/22/4091/6283577)

# 0. TL; DR

**DCCA (Deep Cross-omics Cycle Attention)** 是一个用于联合分析单细胞多组学数据的计算工具。**DCCA** 的核心是结合了**变分自编码器（VAE）**和**注意力转移（Attention-Transfer）**机制，能够利用一种组学数据来微调为另一种组学数据训练的网络。

**DCCA** 不仅是一个整合工具，它还能够剖析细胞异质性，学习到的潜在表征能够更清晰地分离细胞类型；数据去噪与聚合，通过其生成式解码器，有效修复两种模态数据中的稀疏信号；构建跨组学关联，为推断新的转录调控关系提供坚实基础。

# 1. 背景介绍

单细胞基因组学的最新技术突破，如**scNMT-seq**、**SNARE-seq**和**SHARE-seq**，使我们能够在同一个细胞内同时捕获多种分子信息，例如**mRNA**（信使**RNA**）、**染色质可及性**和**DNA甲基化**。这些多组学数据为我们提供了比单一组学更丰富的细胞状态信息，使我们能更全面地刻画细胞异质性和转录调控程序。

基因表达是一个受到精密调控的过程，其中**转录因子（TF）**与顺式调控元件的结合至关重要。**scRNA-seq**描绘了基因的表达水平，而**scATAC-seq**等表观基因组学技术则揭示了这些顺式调控元件的开放状态。因此，整合这两种组学数据，对于揭示与细胞异质性相关的调控层面具有非凡的意义。

然而数据内在属性存在巨大差异
*   不平衡的稀疏性： **scATAC-seq**数据通常比**scRNA-seq**数据稀疏得多（例如，**sci-CAR-seq**中超过99%的条目为零）。
*   异质性差异：不同模态捕捉到的细胞状态可能既相关又有所区别。
*   维度不匹配：**scATAC-seq**的特征维度（**peaks**）通常是**scRNA-seq**（**genes**）的10到20倍。

现有方法的局限性
*   线性模型的局限：如**MOFA+**和**scAI**等方法基于线性假设（如**PCA**或矩阵分解），难以捕捉生物数据中固有的复杂非线性关系。
*   特征转换的信息损失：许多方法（如**Seurat v3, LIGER**）需要先将**scATAC-seq**数据转换为“基因活性得分”，以匹配**scRNA-seq**的基因特征空间。这个转换过程不可避免地会丢失原始的、有价值的位点信息。
*   共享空间的牺牲：虽然性能优越，但它将所有模态强制投影到一个共同的嵌入空间，这可能牺牲了部分模态特异性的模式。

为了克服这些局限，作者提出了一种新的思路：我们是否可以为每个模态学习一个独立但相互协调的潜在空间？我们能否利用信息更丰富的模态（如**scRNA-seq**）作为教师，来指导和微调信息更稀疏的模态（如**scATAC-seq**）的学习过程？

# 2. DCCA 模型

**DCCA**模型的核心思想是通过**变分自编码器（VAE）**为每个组学数据独立建模，然后通过**循环注意力转移**机制来协调它们，构建跨模态的关联。

![](https://pic1.imgdb.cn/item/69609ff03278aeeee21d47ec.png)

## 2.1 DCCA 模型的基本结构

**DCCA**首先为每个模态（以**scRNA-seq**和**scEpigenomics**为例）构建一个独立的**VAE**。

对于**scRNA-seq**数据 $x$，编码器 $E_x$ 将其映射到一个$K$维的潜在空间，得到潜在表征 $z_x$。对于**scEpigenomics**数据 $y$，编码器 $E_y$ 将其映射到$K$维的潜在空间，得到潜在表征 $z_y$。这两个潜在空间是分离的，各自捕捉其对应模态的特征。

从 $z_x$ 出发，通过解码器 $D_{ux}$ 和 $D_{hx}$，重构出**负二项（NB）**分布的参数（均值 $\mu_x$ 和离散度 $\theta_x$），用于生成**scRNA-seq**的计数数据。从 $z_y$ 出发，通过解码器 $D_{uy}$，重构出**伯努利（Ber）**分布的参数（均值 $\mu_y$），用于生成**scEpigenomics**的二值化数据。

每个独立的**VAE**都通过最大化其**证据下界（ELBO）**来进行训练。**ELBO**包含两部分：重构损失确保潜在表征能够足够好地重构原始数据；**KL**散度损失促使潜在分布 $q(z\|x)$ 接近于先验分布 $p(z)$（通常是标准高斯分布）。
    
$$
\log p(x|z_x) \ge \mathbb{E}_{z_x \sim q(z_x|x,E_x)}(\log p(x|z_x, D_{ux}, D_{hx})) - k_1 D_{KL}(q(z_x|x,E_x) \| p(z))
$$

## 2.2 注意力转移

在独立训练每个**VAE**的基础上，**DCCA**引入了其核心机制——**注意力转移**，以协调两个潜在空间。**DCCA**将信息更丰富、信噪比更高的**scRNA-seq**模态视为教师，将更稀疏、噪声更大的**scEpigenomics**模态视为学生。在训练学生网络（**scEpigenomics VAE**）时，除了其自身的**ELBO**损失外，额外引入了一个注意力转移损失项。这个损失项强制要求学生的潜在表征 $z_y$ 与其对应的教师潜在表征 $z_x$ 之间的**L2**距离最小化。
    
$$
L_{ty} = \log p(y|z_y) - \beta_2 \sum_{i=0}^{K-1} \| z_x^i - z_y^i \|^2
$$
    
通过这个额外的损失项，来自教师网络（**scRNA-seq**）的、关于细胞状态的知识，就被转移或注入到了学生网络（**scEpigenomics**）的学习过程中，从而指导和微调了 $z_y$ 的学习。

更进一步，这个过程可以循环进行。在学生网络得到提升后，它也可以反过来充当教师，去指导原始的教师网络。因此，**scRNA-seq**网络的损失函数也增加了一个类似的注意力转移项：
    
$$
L_{tx} = \log p(x|z_x) - \beta_1 \sum_{i=0}^{K-1} \| z_y^i - z_x^i \|^2
$$

通过这种循环的、相互监督的注意力转移机制，**DCCA**最终为每个模态都学习到了一个既保留自身特性、又吸收了对方知识的、协调但分离的潜在表征。

## 2.3 基于DCCA的调控网络推断

**DCCA**学习到的高质量、去噪后的多组学数据，为推断转录调控关系提供了坚实基础。其推断流程如下：
1.  **识别TF-Peak关联：** 使用**chromVAR**工具，在原始**scATAC-seq**数据中识别转录因子（**TF**）基序（**motif**）的富集情况，从而得到TF与**peak**的潜在结合关系。
2.  **识别Peak-TG关联：** 计算每个基因（**TG**，靶基因）与其附近**peaks**之间的皮尔逊相关性，通过与随机背景比较来确定显著相关的**peak-TG**对。
3.  **推断TF-TG关系：** 如果一个**TF**能结合到一个与**TG**显著相关的**peak**上，则认为该**TF**与**TG**之间存在潜在的调控关系。
4.  **GLR模型筛选：** 最后，使用广义线性回归（**GLR**）模型（带岭回归惩罚），以**TG**的表达量为因变量，以其所有潜在**TF**的表达量为自变量进行回归。通过五折交叉验证，筛选出对**TG**表达具有显著预测能力的**TF**，作为最终的调控关系。

# 3. 实验分析

作者在一系列模拟和真实的、来自不同技术平台的多组学数据集上，对**DCCA**的性能进行了系统性的评估，并与多种**SOTA**方法进行了比较。

## 3.1 实验一：细胞系混合数据

作者首先在一个由四种人类细胞系混合而成的**SNARE-seq**数据集上评估了**DCCA**。

**UMAP**可视化显示，**DCCA**学习到的联合嵌入，其细胞类型分离效果显著优于**MOFAþ, scAI**等线性方法，也优于**scVI, cisTopic**等单模态方法（图A）。

在定量的聚类准确性评估中（**ARI**和**NMI**指标），**DCCA**的性能与**scMVAE-PoE**和**MOFA+**相当，均处于第一梯队，显著优于其他方法（图B）。

**DCCA**去噪后的**scRNA-seq**和**scATAC-seq**数据之间的一致性（通过**Kappa系数**和**基因-peak相关性**评估）显著高于其他所有方法，证明了其注意力转移机制在构建跨模态关联上的有效性（图C）。

基于**DCCA**去噪后的**scATAC-seq**数据计算的**TF motif**活性，其细胞类型特异性模式最为清晰，成功识别出了**JUN**在**BJ**细胞、**GATA2**在**K562**细胞中的特异性高活性等已知模式（图D, E）。

![](https://pic1.imgdb.cn/item/6960a2163278aeeee21d48c9.png)

## 3.2 实验二：真实复杂组织数据

作者进一步在更复杂的**PBMC 3K（10x Multiome）**和小鼠皮肤（**SHARE-seq**）数据集上验证了**DCCA**的性能。

在**PBMC**数据中，**DCCA**是少数能够清晰区分**MAIT细胞**、**NK细胞**和**CD8+ TEM**等高度相似T细胞亚群的方法之一。同时，它也能很好地区分**CD14+**和**CD16+**单核细胞（图A）。

无论是在**PBMC**数据还是在更大规模（约3.5万细胞）的小鼠皮肤数据上，**DCCA**在聚类准确率（**ARI**和**NMI**）上均**优于**所有被比较的**MOMs**（多组学方法）和**SOMs**（单组学方法）（图B）。

基于**DCCA**去噪后的**PBMC**数据，作者推断了**TF-TG**调控网络，并发现其预测结果在已知的调控数据库（**hTFtarget**）中显著富集，其性能优于**scMVAE**和**MOFA+**等方法。此外，推断出的调控网络还展现出高度的细胞类型特异性（图E, F）。

![](https://pic1.imgdb.cn/item/6960a2673278aeeee21d48ea.png)

## 3.3 实验三：生成缺失的细胞或组学数据

作者在一个包含三个小鼠胚胎发育阶段（**E5.5, E6.5, E7.5**）的**scNMT-seq**数据集上进行了测试，其中**E5.5**阶段只有**scRNA-seq**数据。

作者首先在拥有配对数据的**E6.5**和**E7.5**阶段上训练**DCCA**模型。然后，利用训练好的模型，将只有**scRNA-seq**数据的**E5.5**阶段细胞投影到联合嵌入空间中。结果显示，这些新来的细胞被正确地放置在了发育轨迹的起始位置，并且其内部的细胞类型结构也得到了清晰的展示（图A）。

![](https://pic1.imgdb.cn/item/6960a2f03278aeeee21d4916.png)

进一步，作者利用训练好的模型，为**E5.5**阶段的细胞生成了它们缺失的**scMethylation**（甲基化）数据。通过五折交叉验证，作者证明了这种跨模态生成的数据与真实数据具有高度的正相关性（图B）。同样，在其他数据集上，从**scRNA-seq**生成的**scATAC-seq**数据也与真实数据高度相关（**Pearson**系数高达0.9-0.98）。

![](https://pic1.imgdb.cn/item/6960a3073278aeeee21d491a.png)

这些结果表明，**DCCA**不仅是一个整合工具，更是一个强大的生成模型，能够以一种具有生物学意义的方式，补全和扩展现有的数据集。