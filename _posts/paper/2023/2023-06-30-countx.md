---
layout: post
title: 'Open-world Text-specified Object Counting'
date: 2023-06-30
author: 郑之杰
cover: 'https://pic.imgdb.cn/item/667e79d4d9c307b7e9760915.png'
tags: 论文阅读
---

> 开放世界文本指定目标计数.

- paper：[Open-world Text-specified Object Counting](https://arxiv.org/abs/2306.01851)

受益于使用大规模图像-文本配对数据(如**CLIP**)进行联合文本-图像编码预训练的图像编码器的可用性，本文提出了单阶段开放世界图像计数模型**CounTX**，其中要计数的目标在推理时由文本描述指定。

![](https://pic.imgdb.cn/item/667e7c4dd9c307b7e97b7119.png)

**CounTX**模型由图像编码器、文本编码器、特征交互模块和解码器组成。
- 图像编码器使用在**LAION-2B**上预训练的**CLIP**的视觉编码器**ViTB-16**，模型的**patch**大小为16×16，共12层，最终嵌入维数为512。只图像编码器输出的**patch**令牌被使用，**CLS令**牌被丢弃。
- 文本编码器使用与上述视觉编码器共同预训练的**CLIP**的文本编码器，上下文长度为77，有12层，最终嵌入维数为512，将类别描述转换为单个512维特征向量。
- 特征交互模块是嵌入维数为512的两个**Transformer**解码器层，使用图像特征计算查询向量，使用文本特征计算键向量和值向量。输出被重塑成具有512通道的空间特征映射。
- 解码器首先将空间特征的每个通道使用双线性插值上采样到24×24像素，然后渐进上采样产生与输入图像具有相同高度和宽度的特征映射，并具有256个通道。使用1 × 1卷积将这些通道组合成单通道密度图。

![](https://pic.imgdb.cn/item/668206f1d9c307b7e90a89c0.png)

在计数任务上微调**CounTX**之前，图像编码器和文本编码器使用**CLIP**对大量的图像-文本对进行预训练，将输入的图像和类描述映射到联合文本-图像嵌入空间，帮助特征交互模块比较来自两种模式的数据。因此，图像编码器和文本编码器首先使用来自**CLIP**的预训练权重初始化。然后文本编码器被冻结，而图像编码器在计数任务上与模型的其余部分进行微调，这种微调和冻结图像和文本编码器的组合可以产生最佳性能。

![](https://pic.imgdb.cn/item/667e822fd9c307b7e985e616.png)

作为计数任务常用的**FSC-147**数据集，其类别名不能准确描述被计数的目标。作者将**FSC-147**类名转换为对“应该计算什么目标”这个问题的回答。并纠正发现的错误。将这组描述命名为“**FSC-147-D**”。

![](https://pic.imgdb.cn/item/667e82dcd9c307b7e98703c4.png)

实验结果表明，在**FSC-147-d**上训练的**CounTX**在**FSC-147**上的所有测量中，对于文本指定的目标计数都达到了最先进的性能。

![](https://pic.imgdb.cn/item/667e83bcd9c307b7e9887e58.png)

为了验证**CounTX**使用类别描述对目标进行计数，将**FSC-147**测试集中的图像对拼接在一起，并让**CounTX**负责预测同一拼接图像中不同类别的计数。下图给出了一些使用类别描述来区分目标的例子。

![](https://pic.imgdb.cn/item/667e8478d9c307b7e989adbb.png)